# nerv

![Статус проекта - Реализация базового функционала](https://img.shields.io/badge/Статус_проекта-Реализация_базового_функционала-informational)
![C - 90](https://img.shields.io/badge/C-90-2ea44f)

HAL-о подобное нечто созданное за время прохождения курса по программированию МК AVR в 
техникуме. Возможно пригодится в будущем, но это не мой конек. В любом случае это 
игрушечный учебный проект, не для промышленного использования!

P.S. Еще прохожу курс...

## Установка

<!-- Библиотека не является отдельной единицей компиляции, она состоит из одних  -->
<!-- . Это было сделано намерено, так как таким образом компилятор -->
<!-- сможет производить constant evaluation и inlining, убирая весь лишний оверхед.  -->

Чтобы начать использовать nerv, просто скопируйте репозиторий себе в проект:
```
$ git clone https://github.com/dx3mod/nerv.git && rm -rf ./nerv/.git
```

Если вы пользуйтесь [yug](https://github.com/dx3mod/yug), то поместите файлы в 
директорию `vendor`:
```
$ git clone https://github.com/dx3mod/nerv.git vendor/nerv && rm -rf ./vendor/nerv/.git
```

## Поддерживаемые МК

| ATtiny      | ATmega |
|-------------| ------ |
| attiny2313a |        |
| attiny13a   |        |

Если вы не нашли свой микроконтроллер в списке, но очень хочется, то 
вы можете добавить его самостоятельно! Для справки смотрите файлы [`nerv.h`](./nerv.h),
[`attiny13.h`](./devices/attiny13.c).

## Руководство по использованию 

Полноценного руководства так такого нет(пока мб), поэтому директория с [примерами](./examples/)
в вашем распоряжение.

## Дизайн

Текущий дизайн. Библиотека не стремится стать фреймворком, а предлагает только функционал-обвертка 
над базовыми функциями микроконтроллера, что разрабатывается в зависимости от _хотелок_ автора. 

Положения:
* Для абстракции над контактами МК используется Arduino'вская распиновка. То есть 
если видите тип `pin_t`, то этот тип означает, что ожидается номер пина. 
  - Причина. Как показала практика это удобно. А Arduino формат самый распространенный и не имело смысла изобретать свой.
* Библиотека не гарантирует корректность состояний. Забота о них продолжает лежать на 
пользователе!
  - Причина. Пока не был додуман принцип эффективной проверки подобных свойств.
* Интерфейс должен быть простым и красивым, а реализация эффективной. 
  - Причина. Базовые функции это те функции, которыми пользуются постоянно, именно 
  они могут стать тем самым узким местом при разработке более сложного функционала. 

## Узкие места

Набор предупреждений и рекомендаций:

* Использование в качестве пинов переменные значения уменьшает скорость работы и увеличивает размер выхлопа. Так как требует сопоставлять номер пина с его портом и соответствующему ему битом во время исполнения.

## Для разработчиков

Этот раздел для тех, кто заинтересован в развитии данной библиотеки. 

...

## To-Do 

Первый этап:
- [X] `digital_write`, `digital_read`
- [X] `analog_write`
- [ ] `analog_read`

Следующий этап:
- [ ] `shiftIn`, `shiftOut`

...


<!-- При разработке новых  функций или изменения существующих необходимо руководствоваться следующими положениями: -->
<!-- интерфейс должен быть простым и красивым, а реализация эффективной. Обращайте внимание на то,  -->
<!-- во что это раскрывает компилятор ваши функции. -->
